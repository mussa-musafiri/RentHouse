<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RentHub - Login/Register</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Segoe UI',sans-serif;overflow-x:hidden;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;display:flex;justify-content:center;align-items:center;padding:20px;}
.main-container{display:flex;width:100%;max-width:1200px;min-height:700px;background:rgba(255,255,255,0.9);border-radius:20px;overflow:hidden;box-shadow:0 15px 50px rgba(0,0,0,0.2);}
.left-panel{flex:1;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:40px;display:flex;flex-direction:column;justify-content:space-between;}
.logo{display:flex;align-items:center;margin-bottom:30px;}
.logo i{font-size:32px;margin-right:15px;}
.logo h1{font-size:28px;font-weight:700;}
.tagline{margin-bottom:40px;font-size:18px;line-height:1.6;}
.features{margin-bottom:40px;}
.feature{display:flex;align-items:center;margin-bottom:20px;}
.feature i{font-size:20px;margin-right:15px;width:24px;text-align:center;}
.social-links{display:flex;gap:15px;}
.social-links a{color:white;font-size:20px;transition:transform 0.3s;}
.social-links a:hover{transform:translateY(-3px);}
.right-panel{flex:1;padding:40px;display:flex;align-items:center;justify-content:center;}
.form-container{width:100%;max-width:400px;}
.form{width:100%;}
.form-header{text-align:center;margin-bottom:30px;}
.form-header h2{font-size:28px;color:#333;margin-bottom:10px;}
.form-header p{color:#777;}
.input-group{position:relative;margin-bottom:25px;}
.input-group i{position:absolute;left:15px;top:50%;transform:translateY(-50%);color:#764ba2;}
.input-group input{width:100%;padding:15px 15px 15px 45px;border:1px solid #ddd;border-radius:8px;font-size:16px;transition:all 0.3s;}
.input-group input:focus{border-color:#764ba2;box-shadow:0 0 0 2px rgba(118,75,162,0.2);outline:none;}
.input-group label{position:absolute;left:45px;top:50%;transform:translateY(-50%);color:#999;pointer-events:none;transition:all 0.3s;}
.input-group input:focus + label, .input-group input:not(:placeholder-shown) + label{top:-10px;left:15px;font-size:12px;background:white;padding:0 8px;color:#764ba2;}
.submit-btn{width:100%;padding:15px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:all 0.3s;}
.submit-btn:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(118,75,162,0.3);}
.form-toggle{text-align:center;margin-top:25px;color:#777;}
.form-toggle a{color:#764ba2;text-decoration:none;font-weight:600;}
.form-toggle a:hover{text-decoration:underline;}
.success-message,.error-message{padding:12px;border-radius:8px;margin-bottom:20px;display:none;}
.success-message{background:#d4edda;color:#155724;border:1px solid #c3e6cb;}
.error-message{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb;}
.hidden{display:none;}
@media (max-width:900px){.main-container{flex-direction:column;max-width:500px;}.left-panel,.right-panel{padding:30px;}}
</style>
</head>
<body>

<div class="main-container">
  <div class="left-panel">
    <div class="logo"><i class="fas fa-home"></i><h1>RentHub</h1></div>
    <div class="tagline"><p>Find your perfect home with ease. Connect with trusted landlords and discover amazing rental properties in your area.</p></div>
    <div class="features">
      <div class="feature"><i class="fas fa-search"></i><span>Smart Property Search</span></div>
      <div class="feature"><i class="fas fa-shield-alt"></i><span>Verified Listings</span></div>
      <div class="feature"><i class="fas fa-handshake"></i><span>Direct Owner Contact</span></div>
      <div class="feature"><i class="fas fa-mobile-alt"></i><span>Mobile Friendly</span></div>
    </div>
    <div class="social-links">
      <a href="#"><i class="fab fa-facebook-f"></i></a>
      <a href="#"><i class="fab fa-twitter"></i></a>
      <a href="#"><i class="fab fa-instagram"></i></a>
      <a href="#"><i class="fab fa-whatsapp"></i></a>
      <a href="#"><i class="fab fa-telegram"></i></a>
    </div>
  </div>

  <div class="right-panel">
    <div class="form-container">
      <div id="successMessage" class="success-message"></div>
      <div id="errorMessage" class="error-message"></div>

      <!-- REGISTER FORM -->
      <div class="form" id="registerForm">
        <div class="form-header"><h2>Create Account</h2><p>Join RentHub and start your journey</p></div>
        <div class="input-group"><i class="fas fa-user"></i><input type="text" id="regUsername" placeholder=" " required><label>Full Name</label></div>
        <div class="input-group"><i class="fas fa-phone"></i><input type="tel" id="regPhone" placeholder=" " required><label>Phone Number</label></div>
        <div class="input-group"><i class="fas fa-lock"></i><input type="password" id="regPassword" placeholder=" " required><label>Password</label></div>
        <div class="input-group"><i class="fas fa-lock"></i><input type="password" id="regConfirm" placeholder=" " required><label>Confirm Password</label></div>
        <button class="submit-btn" id="registerBtn">Create Account</button>
        <div class="form-toggle">Already have an account? <a href="#" class="login-link">Sign In</a></div>
      </div>

      <!-- LOGIN FORM -->
      <div class="form hidden" id="loginForm">
        <div class="form-header"><h2>Welcome Back</h2><p>Sign in to your RentHub account</p></div>
        <div class="input-group"><i class="fas fa-user"></i><input type="text" id="loginUsername" placeholder=" " required><label>Full Name</label></div>
        <div class="input-group"><i class="fas fa-lock"></i><input type="password" id="loginPassword" placeholder=" " required><label>Password</label></div>
        <button class="submit-btn" id="loginBtn">Sign In</button>
        <div class="form-toggle">Don't have an account? <a href="#" class="register-link">Create Account</a></div>
      </div>
    </div>
  </div>
</div>

<script>
// Initialize Supabase
const SUPABASE_URL = 'https://wnxhkgfgllgnegsataml.supabase.co';
const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndueGhrZ2ZnbGxnbmVnc2F0YW1sIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1ODE2ODYzOSwiZXhwIjoyMDczNzQ0NjM5fQ.bAqRDpDvS43ceYM04iKZT3BYkdtipnPwSAKJVqif0-8';
const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

const registerBtn = document.getElementById('registerBtn');
const loginBtn = document.getElementById('loginBtn');
const successMessage = document.getElementById('successMessage');
const errorMessage = document.getElementById('errorMessage');

function showMessage(msg,isSuccess=true){
  const el = isSuccess ? successMessage : errorMessage;
  el.textContent = msg; 
  el.style.display = 'block';
  setTimeout(()=>el.style.display='none',3000);
}

function clearMessages(){
  successMessage.style.display='none'; 
  errorMessage.style.display='none';
}

function toggleForms(){
  document.getElementById('registerForm').classList.toggle('hidden');
  document.getElementById('loginForm').classList.toggle('hidden');
  clearMessages();
}

document.querySelector('.login-link').addEventListener('click', e=>{ e.preventDefault(); toggleForms(); });
document.querySelector('.register-link').addEventListener('click', e=>{ e.preventDefault(); toggleForms(); });

// REGISTER
registerBtn.addEventListener('click', async e=>{
  e.preventDefault(); clearMessages();
  const username = document.getElementById('regUsername').value.trim();
  const phone = document.getElementById('regPhone').value.trim();
  const password = document.getElementById('regPassword').value;
  const confirm = document.getElementById('regConfirm').value;

  if(!username || !phone || !password || !confirm){ showMessage('Fill all fields!',false); return; }
  if(password !== confirm){ showMessage('Passwords do not match!',false); return; }
  if(password.length < 6){ showMessage('Password must be at least 6 characters!',false); return; }

  try{
    const {data:existingUser} = await supabase.from('site_users').select('*').eq('full_name', username).single();
    if(existingUser){ showMessage('Username already exists!',false); return; }

    const {error} = await supabase.from('site_users').insert([{full_name:username, phone, password}]);
    if(error) throw error;

    showMessage('Account created successfully!');
    document.getElementById('regUsername').value='';
    document.getElementById('regPhone').value='';
    document.getElementById('regPassword').value='';
    document.getElementById('regConfirm').value='';
    setTimeout(()=>toggleForms(),1500);

  }catch(err){ showMessage(err.message,false); }
});

// LOGIN
loginBtn.addEventListener('click', async e=>{
  e.preventDefault(); clearMessages();
  const username = document.getElementById('loginUsername').value.trim();
  const password = document.getElementById('loginPassword').value;

  if(!username || !password){ showMessage('Fill all fields!',false); return; }

  try{
    const {data:user, error} = await supabase.from('site_users').select('*').eq('full_name', username).eq('password', password).single();
    if(error || !user) throw new Error('Invalid username or password');

    localStorage.setItem('currentUser', JSON.stringify(user));
    showMessage(`Welcome back, ${user.full_name}!`);
    setTimeout(()=>window.location.href='index.html',1500);

  }catch(err){ showMessage(err.message,false); }
});
</script>

</body>
</html>
